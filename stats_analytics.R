# Вхідні дані
df <- data.frame(
  A1 = c(16.50, 26.67, 14.55, 7.41, 16.37, 15.43, 26.31, 17.58, 10.78, 18.14, 
         5.11, 20.33, 21.47, 20.79, 18.36, 23.56, 29.03, 20.27, 20.22, 16.44, 
         15.38, 9.20, 15.25, 26.15, 23.19, 23.38, 15.80, 16.83, 18.94, 16.56, 20.02),
  A2 = c(24.13, 19.74, 15.12, 25.41, 27.12, 27.58, 20.78, 20.21, 15.93, 28.00, 
         29.28, 26.51, 27.16, 27.11, 25.73, 18.23, 28.50, 21.39, 28.28, 20.75, 
         35.89, 20.64, 29.59, 21.15, 24.20, 23.39, 29.85, 18.59, 21.13, 19.47, 14.54),
  A3 = c(19.22, 16.83, 8.77, 15.98, 24.71, 22.33, 20.69, 21.38, 10.39, 28.97, 
         11.60, 20.98, 13.30, 13.45, 22.31, 10.21, 24.52, 12.73, 19.07, 13.89, 
         20.57, 17.42, 22.02, 20.94, 23.71, 20.67, 27.96, 24.26, 16.75, 21.82, 21.62),
  A4 = c(24.38, 23.48, 13.11, 18.67, 17.57, 29.88, 22.51, 16.09, 16.19, 9.29, 
         14.73, 11.14, 16.80, 27.42, 14.82, 21.56, 18.56, 9.13, 12.87, 15.86, 
         14.96, 18.21, 20.28, 27.26, 17.26, 20.73, 15.17, 22.40, 11.89, 21.92, 20.63),
  A5 = c(11.76, 10.59, 12.06, 16.31, 14.60, 17.77, 11.60, 16.87, 12.01, 12.09, 
         16.78, 16.37, 10.88, 9.65, 14.95, 13.22, 13.97, 14.40, 17.31, 13.74, 
         12.31, 12.93, 16.24, 12.26, 16.24, 15.68, 15.31, 13.93, 15.85, 14.58, 16.02)
)

# Функція семіквадратичного відхилення
semi_sd <- function(x) {
  m <- mean(x)
  sqrt(mean((x[x < m] - m)^2))
}

# Математичне сподівання
means <- colMeans(df)

# Середньоквадратичне відхилення
sds <- apply(df, 2, sd)

# Семіквадратичне відхилення
ssvs <- apply(df, 2, semi_sd)

# Коефіцієнт варіації
cv <- sds / means

# Коефіцієнт семі варіації
csv <- ssvs / means

# Матриця результатів
results <- data.frame(
  M = round(means, 4),
  SD = round(sds, 4),
  SSV = round(ssvs, 4),
  CV = round(cv, 4),
  CSV = round(csv, 4)
)

# Коефіцієнти кореляції
cor_matrix <- round(cor(df), 4)

#  Вивід
print("ОСНОВНІ ПОКАЗНИКИ:")
print(results)

print("МАТРИЦЯ КОРЕЛЯЦІЇ:")
print(cor_matrix)

########################################################################
# ОСМИСЛЕННЯ «ІДЕАЛЬНОГО» ДВОХАКЦІЙНОГО ПОРТФЕЛЯ
########################################################################

# 1) Критерії, якими керуюсь
# ------------------------------------------------------------
#   - Дивлюсь на середній дохід (M), щоб визначити найбільшу доходність.
#   - Дивлюсь на стандартне відхилення (SD), аби менше втрачати в разі спаду.
#   - Дивлюсь на коефіцієнт кореляції (ρ), щоб правильно диверсифікувати портфель.

# 2) Швидка шпаргалка позначень
# ------------------------------------------------------------
#   M  = математичне сподівання
#   SD = середньоквадратичне відхилення
#   CV = коефіцієнт варіації (SD / M)
#   ρ   = парна кореляція між акціями

# 3) Результати аналізу (A2 та A5)
# ------------------------------------------------------------
#   A2:  M = 23.72  | SD = 4.98  | CV ≈ 0.21
#   A5:  M = 14.14  | SD = 2.20  | CV ≈ 0.16
#   ρ(A2, A5) ≈ 0.17   # кореляція слабенька

# 4) Як я це розумію
# ------------------------------------------------------------
#   - A2 — мій локомотив: найвищий середній дохід.
#   - A5 — мій амортизатор: найнижчий ризик і найкраща стабільність.
#   - Кореляція 0.17 — практично нейтральна. Коли A2 стрибає, A5
#     не обов’язково підстрибне разом із нею.

# 5) Чому НЕ вибрав інші комбінації
# ------------------------------------------------------------
#   - A1 + A5?  У A1 SD висока, а ρ(A1, A5) = -0.26. Негативна
#     кореляція — непогано, та сам A1 поводить себе дуже нервово,
#     коливання ціни найширші, CV найбільший.
#
#   - A2 + A3?  ρ = 0.38 — відчутний «зв’язок», тож диверсифікаційний
#     ефект слабший.
#
#   - A3 + A5 чи A4 + A5?  Прибутковість A3/A4 нижча за A2, тож
#     поступаюся доходністю.

# 6) Моя стратегія
# ------------------------------------------------------------
#   - Беру A2 як ядро прибутку.
#   - Додаю A5, щоб згладити коливання.
#   - (За бажання) підбираю ваги w_A2 :w_A5 так, щоб мінімізувати
#     ризик портфеля або максимізувати Sharpe Ratio.

########################################################################
